#devtools::install_github("MikeJSeo/bipd") # personal github with some imputation related functions
library(bipd)
library(dplyr)
#load imputation methods
library(mice) #pmm
library(miceadds)#2l.pmm
library(micemd) #2l.2stage.norm
library(lme4) #running lmer
library(broom.mixed) #for summarizing lmer results from multiply imputed dataset
library(mitools) #for function imputationList
setwd("C:/Users/mike/Desktop")
data <- read.csv("data_ICBT.csv")
setwd("C:/Users/mike/Desktop")
setwd("C:/Users/swj88/OneDrive/Desktop")
#devtools::install_github("MikeJSeo/bipd") # personal github with some imputation related functions
library(bipd)
library(dplyr)
#load imputation methods
library(mice) #pmm
library(miceadds)#2l.pmm
library(micemd) #2l.2stage.norm
library(lme4) #running lmer
library(broom.mixed) #for summarizing lmer results from multiply imputed dataset
library(mitools) #for function imputationList
setwd("C:/Users/swj88/OneDrive/Desktop")
data <- read.csv("data_ICBT.csv")
#setwd("C:/Users/mike/Desktop/Github/phd/missing")
setwd("~/GitHub/phd/missing")
source("helpful.functions.R")
source("realdata.crossvalidation.R")
#devtools::install_github("MikeJSeo/bipd") # personal github with some imputation related functions
library(bipd)
library(dplyr)
#load imputation methods
library(mice) #pmm
library(miceadds)#2l.pmm
library(micemd) #2l.2stage.norm
library(lme4) #running lmer
library(broom.mixed) #for summarizing lmer results from multiply imputed dataset
library(mitools) #for function imputationList
setwd("C:/Users/swj88/OneDrive/Desktop")
data <- read.csv("data_ICBT.csv")
#devtools::install_github("MikeJSeo/bipd") # personal github with some imputation related functions
library(bipd)
library(dplyr)
#load imputation methods
library(mice) #pmm
library(miceadds)#2l.pmm
library(micemd) #2l.2stage.norm
library(lme4) #running lmer
library(broom.mixed) #for summarizing lmer results from multiply imputed dataset
library(mitools) #for function imputationList
setwd("C:/Users/swj88/OneDrive/Desktop")
data <- read.csv("data_ICBT.csv")
setwd("C:/Users/swj88/OneDrive/Desktop")
source("helpful.functions.R")
source("realdata.crossvalidation.R")
setwd("C:/Users/swj88/Documents/Github/phd/missing")
setwd("C:/Users/swj88/Documents/Github/phd/missing")
source("helpful.functions.R")
source("realdata.crossvalidation.R")
#devtools::install_github("MikeJSeo/bipd") # personal github with some imputation related functions
library(bipd)
library(dplyr)
#load imputation methods
library(mice) #pmm
library(miceadds)#2l.pmm
library(micemd) #2l.2stage.norm
library(lme4) #running lmer
library(broom.mixed) #for summarizing lmer results from multiply imputed dataset
library(mitools) #for function imputationList
setwd("C:/Users/swj88/OneDrive/Desktop")
data <- read.csv("data_ICBT.csv")
setwd("C:/Users/swj88/Documents/Github/phd/missing")
source("helpful.functions.R")
source("realdata.crossvalidation.R")
############################################################################
################ Data cleaning
# pick which treatment to compare
mydata <- data %>% filter(treat.m2 %in% c("TAU", "Guided", "Unguided"))
# merge Guided and Unguided as treatment
mydata <- mydata %>% mutate(treat.m2 = ifelse(treat.m2 %in% c("Guided", "Unguided"), 1, 0)) %>%
rename(treat = treat.m2)
# Delete 2 studies that have same gender(female) for all participants
mydata <- mydata %>% filter(!study %in% c("Forsell, 2017", "Milgrom, 2016")) %>%
mutate(gender = na_if(gender, "")) %>%
mutate(gender = ifelse(gender == "Female", 1, 0))
# Delete a study where ComorbidAnxiety is only observed for treated patients
mydata <- mydata %>% filter(!study %in% c("Christensen, 2004"))
# leave studies two treatment (delete the ones that have only 1)
mydata2 <- mydata %>% group_by(study) %>% filter(length(unique(treat)) == 2)
mydata <- mydata %>% filter(study %in% unique(mydata2$study))
mydata$study <- as.numeric(as.factor(mydata$study))
# visualizing variables
# library(summarytools)
# view(dfSummary(mydata), method = "browser")
# Specify the covariates of interest and type of variable
covariates <- c("baseline", "gender", "age", "relstat", "ComorbidAnxiety", "prevep", "Medication", "alcohol")
typeofvar <- c("continuous", "binary", "continuous", "binary", "binary", "binary", "binary", "binary")
mydata <- mydata %>% select(all_of(c("study", "treat", "y", covariates)))
# Naive approach
set.seed(1)
naiveapproach <- ipdma.impute(mydata, covariates = c("baseline", "gender"), typeofvar = c("continuous", "binary"), interaction = TRUE,
studyname = "study", treatmentname = "treat", outcomename = "y", m = 20)
fit <- with(naiveapproach$imp, lmer(mydata$y ~ (baseline + gender) * treat + (1|study) + (0+treat|study)))
t(sapply(fit$analyses, fixef))
coef_fit <- summary(pool(fit))
coef_fit
